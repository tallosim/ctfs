# Very Big RSA - Cryptography

This challenge was a quite complex RSA challange.

The challenge descriptopn gave the following instructions: *Sometimes you need multiple primes, sometimes you need only one! Decrypt!* and also a `very_big_picture.png` image was provided.

![very_big_picture.png](very_big_picture.png)

## Level 1

The image content wasn't provided any relevent information, however bytewise the image contained some interesting information. First I used [exiftool](https://exiftool.org/) to extract the EXIF information of the image.

```bash
$ exiftool very_big_picture.png

ExifTool Version Number         : 12.67
File Name                       : very_big_picture.png
Directory                       : .
File Size                       : 38 kB
File Modification Date/Time     : 2023:11:13 21:57:08+00:00
File Access Date/Time           : 2023:11:17 17:38:47+00:00
File Inode Change Date/Time     : 2023:11:17 17:38:27+00:00
File Permissions                : -rw-rw-r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 500
Image Height                    : 500
Bit Depth                       : 8
Color Type                      : RGB with Alpha
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
P23588023013858968074669500888771907494856785301791065076681990074744887826955476904270032617187217251445538831848864122592027162990775963441155680953655036259753941131770421259010889670469907851914480870217694253492263435884435998113564601970782069481694604765337245159900014224906123536215423357723997066495009892014146725767925425203283764423114400424190748732848971287451810184178135276405373434516683939993534154481964022742762447301811592145342937718121666907407219225689936328033963359783185374325435557517868959400177570045628185608009385676848499545830858123853820589053495910274009458514057171603137430582159: 
P23901086096787706982746783709104286125812987344654774822011106875326407808141286823321815366147231358305518945534685721874534228558387797365966547595325043529883788805970128495904914713045730788761914544055669815279513782181100064450359968101436305284504155729711640221112517489383402331517187674697746613516210449238644748193770287406875698045243288575412966516889633478800598736100254042539028088635974778404593919042789913001294978480055724827766176739872391526211716646038647401675402452815612483228208558206461495120960549406464301564213238850812290330630552604191938619723174486395841407403994745909393072048727: 
P18066098912936675157129958426423897287225239773841126558273748391505757772094114584794347320018004975589001721607985439074362069385290914735916330113276300278935914378982778465068055290162082668001977553903308360043198833650316438447483087947994161110289024256991119208063846751871750169767132305990755211700166482118059282374112757918194346658814349409625112505364300536148432063915264838407757785828653540513495144884278068267666321867291871848927399327147412169002546840768600663193134738903726577834894215400875327316156483164610024260367505364000521962907106961944105708845727896828139717473977685040992338975409: 
P26566547135449149147758498496375801513743985836825552115354032407058753160621561208963270770759429051213899049698344023943116651118257112184074700137371821788555396174374025009758703702164124977126136040739744195167039602243384795365336289065610826246548297325628650261166349416364768251728762257088986436889628015926140962532153716555053168661217376633518648239782628904078277422948039615724090756280564637971771958060338411157592933172974757646164777434860932673853315131620002816684571394060044608649251796631154870830346381820600647025009022834934537562056411786514412513206174010632560193089945731331846876906439: 
P28312013316040946590118171346512351798567351591082578323517404463309485750991137560714453764428390869749157035798839392292044782814655757515356940097647299781510359841679066223744494948383076744165328243692934986932130798706516895973684932096586545129875963629010972148031975086066814428932185161129392268325835161712582003462743567460238955079031650387028697624684572944391386679045911964544585655602604580403631874686446695572558668046367124675311757367174374782988477125247270299013224920300819051655454060083429388845667559076241185730953619768542170831295416539922559407264714945975218966728073963251522727185343: 
P26914346891290892732889042912428638330726442914168628269333389430773833058395177492793542963513690098085212627678603925487732436247554369024817519062290616502989926441407503335991841042137007510947909698467507127618003429459890771902822029865090172641903645386570909611359096083764805131983863792891299579344716837034694120922945544207302514480913793173240097509131053440195746746656161516039152400506053066948970623579713214798243850256091961559108563969384380939533121363136712596942626619124131852097746304679298241501691962103922305978995863985555217365060063861886030441660839151426695743546250587354142638485641: 
P18930622895388727545439493845147726749114283905674748561120008704303599312139789955015844661870986747330648189808780248167145058687158735878390714166706291102610146994439672689320944835529447549121894973970396060315036803018030461325883900036973197621812774750804181110272928833824566712596148472399481899839356950745803281394751520469124473388370507455438325897481857711194769141832380125682155108758874165502563675675245841114603053355849210652608886606239949641256760928009385549940030496254024876837557199882812352927157788653156034632415373914706167530912818812488051328973669764314791834920183229839156833916397: 
P17332555869615747677226753050097572170853262128585111880602820803716718097290212272845942264430563399818907301927976491686035948417408049799395023958330224342973823949958711160236580784069935082793303305133181797347529175828400175884472470200231098993801547491383859476834281346135839162411910222244140264252575878046870022167948408851005922508092473122527167036508227254833608849530666406588371372326029580041751516992098199046551208196879300294311040527293560631564282245576690516566598992068252344714742404697252131269931330911390665709131416164769044299230483479827411204098535594271047383638947283516908876671689: 
P29044638053673400599388717768500794345896034343644086274294346884160986871589097808524971710447770548538629437588640477085752271002979416407239242905622959484599435174772595063304288539366301686286238237081649793329457370224450676335300625175926380315520266816631753200951289780502909591297046955061279030837633772819908258309912731258503283914633635037219607404478046766473334175083737347596192683324904795936040061789823074108796254386994030158409603489399846566065424010719711156492678001897410051851745890397555394114007373395931501256310097137729536409748747917116615133211275084617117152949469620368444999528999: 
P26356325903074697950051857138950371665735273271996254618092997045339040522194835162775159572309570465684689525089277206566051797920645038739617838172269253080034686006492021414065693269918637549854298608733426154436129288283882140776968941227915442683208363248482492743041771450210813138268537943693815515205236073838139832094451188198287812753266945207871482311655694707792666829803987927084798969963283573120556912830024708982215176193516268641754480806218888247617139394260323618217700282188165250631884908673047208731566742602099001311401454723908189736638069408145569092545466070440614405807530274784354374687387: 
Warning                         : Corrupted PNG image
Image Size                      : 500x500
Megapixels                      : 0.250
```

From this we got 10 different primes. Furthermore, I looked the image content bytewise with [hexdump](https://man7.org/linux/man-pages/man1/hexdump.1.html) and found out that the image contained more primes and also chipertext.

The primes:

```bash
$ hexdump -C very_big_picture.png | grep 'p='

00000020  8a 00 00 02 6e 74 45 58  74 7e 70 3d 32 33 35 38  |....ntEXt~p=2358|
000002a0  45 58 74 7e 70 3d 32 33  39 30 31 30 38 36 30 39  |EXt~p=2390108609|
00000510  00 da ed f5 6e 00 00 02  6e 74 45 58 74 7e 70 3d  |....n...ntEXt~p=|
00000790  00 02 6e 74 45 58 74 7e  70 3d 32 36 35 36 36 35  |..ntEXt~p=265665|
00000a10  74 7e 70 3d 32 38 33 31  32 30 31 33 33 31 36 30  |t~p=283120133160|
00000c80  e3 c4 10 00 00 02 6e 74  45 58 74 7e 70 3d 32 36  |......ntEXt~p=26|
00000f00  6e 74 45 58 74 7e 70 3d  31 38 39 33 30 36 32 32  |ntEXt~p=18930622|
00001180  70 3d 31 37 33 33 32 35  35 35 38 36 39 36 31 35  |p=17332555869615|
000013f0  79 00 00 02 6e 74 45 58  74 7e 70 3d 32 39 30 34  |y...ntEXt~p=2904|
00001670  45 58 74 7e 70 3d 32 36  33 35 36 33 32 35 39 30  |EXt~p=2635632590|
00004d30  9e 58 51 ac f2 31 7e 70  3d 32 32 35 36 30 31 35  |.XQ..1~p=2256015|
00004fa0  38 31 2e 7e 70 3d 31 36  33 31 31 39 38 30 33 31  |81.~p=1631198031|
00005210  7e 70 3d 31 39 39 36 37  37 30 31 36 39 39 31 36  |~p=1996770169916|
00005470  32 36 33 36 37 31 38 38  34 31 34 31 2e 7e 70 3d  |263671884141.~p=|
000056e0  35 31 30 37 39 34 33 32  39 2e 7e 70 3d 32 30 32  |510794329.~p=202|
00005950  35 38 35 32 32 31 2e 7e  70 3d 33 32 31 30 35 31  |585221.~p=321051|
00005bc0  34 39 31 2e 7e 70 3d 32  34 32 35 38 39 33 35 37  |491.~p=242589357|
00005e30  2e 7e 70 3d 32 37 37 37  30 32 36 34 30 39 31 39  |.~p=277702640919|
00006300  30 38 33 36 31 39 31 34  33 37 2e 7e 70 3d 32 35  |0836191437.~p=25|
```

The chipertext:

```bash
$ hexdump -C very_big_picture.png | grep 'C='

00006580  ae 42 60 82 7e 43 3d 31  38 39 35 33 35 38 30 34  |.B`.~C=189535804|
```

I wrote a Python script to extract the primes and the chipertext from the image.

```python
#!/usr/bin/env python3

# To use bigger numbers than 10^4300, we need to set the max number of digits to 0
import sys
sys.set_int_max_str_digits(0)

with open('very_big_picture.png', 'rb') as f:
	data = f.read()

# Find all the primes in the file. A prime starts with 0x703d and ends with 0x2e
primes = []
for i in range(len(data)):
	if data[i] == 0x70 and data[i+1] == 0x3d:
		prime = []
		for j in range(i+2, len(data)):
			if data[j] == 0x2e:
				primes.append(int(''.join(prime)))
				break
			prime.append(chr(data[j]))

# Find the chiper text. The chiper text starts with 0x433d and ends with the file
for i in range(len(data)):
	if data[i] == 0x43 and data[i+1] == 0x3d:
		chiper = []
		for j in range(i+2, len(data)):
			chiper.append(chr(data[j]))
		chiper = int(''.join(chiper))
		break

print('Primes:')
for prime in primes:
	print(prime)

print('\nChiper text:\n', chiper)
```

The 20 primes:

```python
23588023013858968074669500888771907494856785301791065076681990074744887826955476904270032617187217251445538831848864122592027162990775963441155680953655036259753941131770421259010889670469907851914480870217694253492263435884435998113564601970782069481694604765337245159900014224906123536215423357723997066495009892014146725767925425203283764423114400424190748732848971287451810184178135276405373434516683939993534154481964022742762447301811592145342937718121666907407219225689936328033963359783185374325435557517868959400177570045628185608009385676848499545830858123853820589053495910274009458514057171603137430582159
23901086096787706982746783709104286125812987344654774822011106875326407808141286823321815366147231358305518945534685721874534228558387797365966547595325043529883788805970128495904914713045730788761914544055669815279513782181100064450359968101436305284504155729711640221112517489383402331517187674697746613516210449238644748193770287406875698045243288575412966516889633478800598736100254042539028088635974778404593919042789913001294978480055724827766176739872391526211716646038647401675402452815612483228208558206461495120960549406464301564213238850812290330630552604191938619723174486395841407403994745909393072048727
18066098912936675157129958426423897287225239773841126558273748391505757772094114584794347320018004975589001721607985439074362069385290914735916330113276300278935914378982778465068055290162082668001977553903308360043198833650316438447483087947994161110289024256991119208063846751871750169767132305990755211700166482118059282374112757918194346658814349409625112505364300536148432063915264838407757785828653540513495144884278068267666321867291871848927399327147412169002546840768600663193134738903726577834894215400875327316156483164610024260367505364000521962907106961944105708845727896828139717473977685040992338975409
26566547135449149147758498496375801513743985836825552115354032407058753160621561208963270770759429051213899049698344023943116651118257112184074700137371821788555396174374025009758703702164124977126136040739744195167039602243384795365336289065610826246548297325628650261166349416364768251728762257088986436889628015926140962532153716555053168661217376633518648239782628904078277422948039615724090756280564637971771958060338411157592933172974757646164777434860932673853315131620002816684571394060044608649251796631154870830346381820600647025009022834934537562056411786514412513206174010632560193089945731331846876906439
28312013316040946590118171346512351798567351591082578323517404463309485750991137560714453764428390869749157035798839392292044782814655757515356940097647299781510359841679066223744494948383076744165328243692934986932130798706516895973684932096586545129875963629010972148031975086066814428932185161129392268325835161712582003462743567460238955079031650387028697624684572944391386679045911964544585655602604580403631874686446695572558668046367124675311757367174374782988477125247270299013224920300819051655454060083429388845667559076241185730953619768542170831295416539922559407264714945975218966728073963251522727185343
26914346891290892732889042912428638330726442914168628269333389430773833058395177492793542963513690098085212627678603925487732436247554369024817519062290616502989926441407503335991841042137007510947909698467507127618003429459890771902822029865090172641903645386570909611359096083764805131983863792891299579344716837034694120922945544207302514480913793173240097509131053440195746746656161516039152400506053066948970623579713214798243850256091961559108563969384380939533121363136712596942626619124131852097746304679298241501691962103922305978995863985555217365060063861886030441660839151426695743546250587354142638485641
18930622895388727545439493845147726749114283905674748561120008704303599312139789955015844661870986747330648189808780248167145058687158735878390714166706291102610146994439672689320944835529447549121894973970396060315036803018030461325883900036973197621812774750804181110272928833824566712596148472399481899839356950745803281394751520469124473388370507455438325897481857711194769141832380125682155108758874165502563675675245841114603053355849210652608886606239949641256760928009385549940030496254024876837557199882812352927157788653156034632415373914706167530912818812488051328973669764314791834920183229839156833916397
17332555869615747677226753050097572170853262128585111880602820803716718097290212272845942264430563399818907301927976491686035948417408049799395023958330224342973823949958711160236580784069935082793303305133181797347529175828400175884472470200231098993801547491383859476834281346135839162411910222244140264252575878046870022167948408851005922508092473122527167036508227254833608849530666406588371372326029580041751516992098199046551208196879300294311040527293560631564282245576690516566598992068252344714742404697252131269931330911390665709131416164769044299230483479827411204098535594271047383638947283516908876671689
29044638053673400599388717768500794345896034343644086274294346884160986871589097808524971710447770548538629437588640477085752271002979416407239242905622959484599435174772595063304288539366301686286238237081649793329457370224450676335300625175926380315520266816631753200951289780502909591297046955061279030837633772819908258309912731258503283914633635037219607404478046766473334175083737347596192683324904795936040061789823074108796254386994030158409603489399846566065424010719711156492678001897410051851745890397555394114007373395931501256310097137729536409748747917116615133211275084617117152949469620368444999528999
26356325903074697950051857138950371665735273271996254618092997045339040522194835162775159572309570465684689525089277206566051797920645038739617838172269253080034686006492021414065693269918637549854298608733426154436129288283882140776968941227915442683208363248482492743041771450210813138268537943693815515205236073838139832094451188198287812753266945207871482311655694707792666829803987927084798969963283573120556912830024708982215176193516268641754480806218888247617139394260323618217700282188165250631884908673047208731566742602099001311401454723908189736638069408145569092545466070440614405807530274784354374687387
22560159148758655251090279530993267136217005614371930902414495068525351270537114544709743113399804188966523745021661259892416321594913567088716062014753566784348108967648584965664020362531449833422165282401466468143924349026258442546869937943085874087130294959133103205248830724078588609625406251751065139443701216107366168711985967389266879432587610765699258469087152237107951929673951586340653563297910892326721262201207964545436756606393688707084380703344539829670325679357758957047675724578659606055373307137896456622253445173524733587350144772450383375758946057436470522450448799851967389027350284497664159213581
16311980317052045198685014114358734571848282136218648464367115769757619318163442461258771893794298138122372917481845789850630913050276684080909535059181491287899750965384413574389097094233936155582813329123537549690471632105142576723483464079891296345984171665748266991783923917105320652603180097492641378360659036083542854029076424911262631283405417784679628292629738867832247334227095038603775459298786307394239511449990100458198704216790210563442059766459665770500224544364756230341718700889156252424055256002662825432630615657905893152018628913709438963028154830245907694808047005571622384693738976347289413401511
19967701699167392498614917648886890323737614156595255258942598476516385786502655070410125586223884432031618624482086330449895862127795231579136845818621646593247813206646254088278894189267040423510807762390910924274394709976526621034037865283365160093203042037598439126650440882999032517772137736999962532896029533435591871871288298400902922102766067264396180059527616265050053232693828143748436854966091411364228737954825942472664763429546131325347080288608312316844819177672180368846856090498598663945482957760605615927437171255774728278360207304163952173174343871084502973972148892299990957307427343516263671884141
30739705965510031817993243824947623360889811949866997147673195177468833861122004142725158540971310903326943521096316689262033294023848042681877851443648482087448216045983026332754000185195206046086644592474242152609799771014933841186170450925861190685442450233683187435684538919599479929365319386254457145998291824138448500283159911764412596002416854340791728307133512877908655940984997328477209082194424954920461971050381703710954382420443845846082562473231387158094808756677824246945802285184089968314789286600755492512734874117723105121327001494883664169536899565141212344029234300664179209168256857853682510794329
20205122530253323757945521194003296110764271382695490970499825336511002995969646544662818125224172484943122362318586842210884757926770413776965771727987580016820569656455160442105704785863581362298431171668126310198840370724251812964489531921192811599202859130751118317826211881919209662777607616207018272068411869448743735715435526703459487016353920850032180338590654271606817181080064577503057479752746788360356121067428632001181163542262966923446967165616447921350273676011620069712760376522058783567436243498109975744218535730721274652126040824922154234147741002439196729803423729820887714766866746844175380585221
32105199093749967227545260620614238795140218489091510827731725453400784865046921828070575241111339415217782430395124273786480227759841274434210096887321775767271721585210750336995481277201981653652679189770312498688677104878834190771299906111350433065500244082352095277016126636051946584931274055083797444768457920047601413660446013968090813641134109356849876599181972460539652148663591081851568336640994751307090470520976119772377724466639926206007705638994359810155710628621272680836712089468853285292855169671972210457983674832127183015004509743613972013936421071910105235756975257887784840284007397989582928008491
24258935739842382864128631686274556028824997254163872608528095666438041402537630717334090718928394312671382332907565742771601671347618459246671175433098232859109281798290094199909493388428237881245421533545333375525756570833459645732282810547128576404109758239009444293269691679369105797563211508180075641065750780840762849447006013877805140568267845427274107909713511569650871797712154259162711929721584961988865721194439912503291344601208514034313853933110972456792689522542180100707247772182653273998651522065114153917507060288455053058442790404408429115677359765334549403130006654212734954146581263389065540156497
27770264091971361217000018139068913140817362151013530683095374317617275108890066223624929382748737355270891413920254643582423513283706754357766008022291757276836288182052203812326460704709470811579059050179203382038463657908997040196342696694804428986205898880404126898857243482915482906826228586810044073236126134000015768870456679370795072577843951837614280755918989351786274877654007589938824674339641284658409652279550312306481782663504262841636540761758045210769738340814835726219896084380225061955163161050571253804551451558448452046828358193287759302844220785837058199056208178692164328393058355988619899345059
30996453654411424019078751487094442211656915309555573642672400054292537318555590477170464382423414106859750519742609677812110675560867098413373499726060860595823679645223079357379729335551690173479499076448821554351329024195993276185529935010659211993526870765211329123007891688726465834738040495824189347494926959244519127759271459832744716259134958555286050595886425597576525448964648175722644198439661078121379637979131647359074183616159447142419432427666970788945401853941825738699148430024986236055526315324508271647649952022924598653374035849379773679684507609018481403959406335145268415305284656400530836191437
25552709050817904236896237258523781633197660949080169781747279296296626431308490362426714835718800480402423754407273611933528640230624363451483342275569180803132760872836741243076380009965952332488417638957373843242499687793238882120161783739892878170788304925095286541800009658776695215029777798672865609788533000639383778543858417751214833580400732701596558288590565462993070004603193101857252351882343000494435613320393049500240504940369637926739568145062703418254735715024705474810944624001538258783178235514837917561025427138617076518400807184748869896435980254573470033501534571719526738757020704556179293939989
```

The chipertext:

```python
1895358043641707291462804323372557055751520109793575237158015307530065859259262617826978987058150696860549578269492688190723746589216548952854340823723387692762920952218329500627367381249974892905767994176556401151270516317184124821124159270757612438736063684399191695753649265549983243988216812896331962593218340335647180438045141205106503150967560026234221095249981215217540841104868797812109211744890895183453908161515602972478360146895669955896306502145301020088363729549395319299630237716197942081711874773742143449564748639632647751298152492308713657111665855516840333781702532761244835491132494466587366174519411657550860394331947665766180876205875656470598490899536062515692568409498161066291259332942519357371751241894943845512732193782583389504145321837042677587235706609394033496594402376358971891173070075493359688915285319869419618629174759635740224887428678649734175621536225886754652344147006956854755376711370104614239733864942915243415818090417299412232437034858406220882970046177371398743328306133733807406677248477792923963699850935773327167615853464105260817177839294086799807015901644788786879909417303458849777180162430124478873580971169354149896212309054329466946718159748974199033075585745001537050492927727802808118540662367752364492506177690077939915461502071018562211832981367989145374123537899202819155132720839681677031440812920185820817326484981576872958237010534859010353176783774111742803629616371475706860293381402401354852695459975029993609073202080407963922978117574546875160889765360413640788604291955215003553419069285290068368051566137483087759237656318927494510385559974979565144722450785845948664611547029389370161643926517007916584010822806087439608852694001038692330962009944494898035972082542145333700999641388293725180398604538794024319100590604838188224641571358026256989038450212626461530876750925465409854914718792468989174110229079295671473049464854066410085670914634178674521291944614216401199339621552304235334833442249032498834491841935915156158210928859815788671072380449017195302965772057754926116546098787940914714750441557406889482151225501232184097525702456006295574803399432146981380666724059876813659077773573201783397880424318450369047653272758540059661939510039528469247303417348044271272271698940928815299423477614643023383673567410776485310696000993683013477454046345099386414751286518516072165151381704183932783753551372135665695718509740301999648507075395833400358154219772323440975466872279458152148163627473352234517934476962656360900908432446321284100661630769205737352181176824977581257409032572372613445945412537822673192567991303207711215207935701066113013219777045773966794755612066724935279879949690295724399910151021166373253358961764882707657463480903266039471143339721638275475134996496040813554448072639960606749101579332816916645748720576683333943738472036101715791716718498749071256978010713398325934927135235830900437572764353795361733074882583871512961730439898631277468678260763536712882347062865966094993124225953871118273145974705811890444207064314723145313063953025467670121280592261589386761587879526311457430470102433380588728193559653965895080685522700893326544958718535417306256203014202334244608958889425658779961260575927679743367489465282822443032353080907569099272464090787785671222347820957722487052770333928923670340468042531634421120206873650317334483394837150693805515073879684628741149594634425579216532215511727324791032616334031306275767902982575756874384187927226641367296762974983098975581968062296090552969084496818046504716403864346436994921922594419671108290461119550556346448425028373046614755509730377083220882330888820793094103162602459948784202946342488373416677376341027263918475602732289746588625083547145303491170753077061452962772155985130477486731170689067787424592225492364459594368158658215921322564356695436423899360939542212252445446128123208023361349326460420468756005567791305150907721855020840793833138255315461803500512732888666121987105698834848637427997437776510073055916056079353808868369372885862836523896839719451695680029652924869238057108694789220504028799525802140604730628740909471904538718872630118497709713961591235816049931520287348766415731393105675962108461967631755208763570586858696344560276388072512577142450732651633720915831935749060091168500833414560709567469595535167699447269727126068753458271362857935125577628101701574444948718540177854939074295718300512760536166950056284972001967255356418207457684561957854329767530337873060161736419653484380447926915124754411498785699720563365070560388759420158058717102048033178772809465503011682741417431995047179311138815514912520883068068635505511506565554527080454105346823037368846917125339295675626443587493500485038643182292571308104490110882513585301109011853521647638115886625753458881987351089484653951277339454792551014246920187112390739412177410349507282426419864866431824529865908840765484507440879093580700392884348571411392150172517978391378099518667271574409994711532677436562843063422122433830532295160704867422239297160137911321799421864797052044103856485671451194217379361820547686244135928200615383509124602983099144185171077888053211202380355369166997656020090127454657520221531975095542371603750475910930039381024794605203460179107914026227162127975407740672425318571009175825003982446670061768228850342872702650180507398102164639058822981217148731002474118842239734516789861840923661458002090592822909852727486375563005001764405549097504481555629995817521722117822569703592937061121024496721142198292541970951589860549556155122867076284798761906697082247620578325104324412815830819389266798478141139894374348607578285291048009461162831248633078129503084901457958307528740571339137608235109773555361464955346221129025472748255308081175061387274319170420516308574403715273540260620655882925973012864570159020202862513744103954278342819213412266728523727240935534366374467384688126854935864846870653420584304577766362807087600741656945674544298799915863913950757421865622100216079574459699762512608111830327968858846614676119213444542001906688837934430100882749121434492935795443055142777108101029887591064475179662607864252773934618092797829603018038789440853959984875389358276120546065961856220789733665469448813637932460820379270353066769611418391790319747122070639402812876376453160971629598136514421060288179485020016290781108923187893369713581481538628697495611122159294686880118340742274107357350681792971190495335896380423300996059632268615764810445755260241889536116274198261899146935427117027361785626982455486225210746961551518945878390902400841877973136422107461795870113303278917740021053196010049661024001345342335706025898649067132816295075088000125223200561565177707326077275407111811793655990526226211255274180712087837917199758869881465376681349292959310341864946232486014483698226604290336242128714745945316526206316891732009647061538031289655082262795244591612613560685171650776301301730264041529162889830622471147943897808231283512478259228296035267044351728718872828860684460400567182490678250756297962112497012342122662898798378910547277073898721258556255001673869796394625619021216855546079182770244497680022789945230203489052798390716800167197249765510698879300953307172339915040855375445284877109595599231693407545684130132495597048232389564259293894488971650110750341034617794201646742283523084934622807427146020973372595325310945849502996972119439712668300936382486691344138179922986640972737496881464170317265562543251124017056008478320996394375417288262450712266366382883931982138398281714101339424742516018528702236176204643048974402605140645016447442599951614246708643057141422432533306060009200747363875938135388844944392837911768959410704256444863317152049108798596043701620947154616529179182811442696413107607718258284586877186834680043716886860789346222904695119041314149266862562742118992932841589307214650020331180154954766337711817115832923485529984191323029153709956581201459835765545768416756965667513137044307272540672509556288208882704347660618842563968819098390227613863648627070636089448732827876995030037088967290391791922826001518978009823914807426265656602735761774785543747259274288482156349862497661930643864136309503327053216388089454337791564879081018052131256231810286127466807212239041276575499347780538910364147835612490279454390653357436391605708749714947352556372022688204379905803666316752793714224867912936879056864094811353378260646816431065438992182024684263686432813312903536266764222184086557045244919479287400709268198733405871327287892241644157055231242044379711726342041102639032224725732523291356977057717911338444520918076997027819562710557770446550039077885344643975971534371621358376124669614104161477744390004255558420867005852894848436701366364902490426721705431687066114187564462516794370470231183849353190379008251159728928809066024806610001971172247753877413949843266560286312049690111955533168084060886618321382330926601119273946802203345676364060338168580644483905740074018424520312385458468828272677651960519920636063643806059174790854989101123016151561949033233530598202353401724478656427551687888819527425175136500018034991200239394931253705006824588994702903152805456159766818688230805917138784083430294577742600213748656331800337694634574615714121094855698171218695196560872945067040075478527386786492052465954975028010594573071966262010051830867474314996717149270411518367613312668186928418975161495253066127545889596623383782366685215541691314182481962647858269347225293823142865463319389114410049293474777880939882417971789960589968478824531164231517933288971875719221809585020000658673964779968565718498047828244243192368161436406050177886552880083504669233683384656388339385784041132625309151034415918014639205254018103812197832763827413658845586427914474950251582954023616833120334498583216347830792530247652797986760455075279213567410633783246841083549871180105563038346968634038371731219535797135750891077638314361799331506087119968329684179263271808636218116889428413923509780134702690262125285861204618326144650982686675575467103874423488835212507722393434373777087163009797293419651484837772777427735038003046948913450992591050517129038550776510892804833541743451164407062966783357207322872709508819747685713237413715995327637520834865609516751234520017993680778917307567076804347986923565892521532809369943904586922375045059944774682652669325763936069563169581036412200546534362274391995774818358194181419546321286014554661443434486957247858277925672178638977505168635931818733748090501879900698738032032902122474662406387912809129557641834178832871382779634848103919092035689235015750645270446560333021339482694014155333171043074952282304038155043971327630644870624190274889260333510919151958910552232989814346950045122772719190442109492188624415178263251527817228136220935373628591213652595935105150007781828209759352279881575124269874281657905601018414915677969140625783294053542384186353651126126613679329420765889847423554579366897410099439358078465070868452132846291427361384600564109229270633152611722254475999683562179634069020205381066866777777046184109191276718816119969018223796931196736472503238493479175389575925687584478555121078444187052322871768805984379444358214658884104512587591797825573989811260099062270170213679093673975601735144188252201600206165988892710155373028562490555280079474153370121405410829031883203518104724861940709305054227916137542038213767497899741863273796998847273577024176241757275135632651274581482465632974356602638639255430645313939682321030401369948062399284625124111424210335121772411544861281157899806523131223624432142680595806966052422989067656157872094128112870358670293001829323512046990117763705189025223491329860265494117508091374288438954847036882073382931065661942300354504678021842062695523707583737131895005891751061814182800269935602844229452357538223923341024280018412587628591443673263813103852274052829099037753471978446025560709558619293136203086980013276333215343961137544475149867979100359250348497867223281606077439474868865262006508348391726923699845090930744370431581219574866713803037238905954662965497239657775381992064919342945082642539464018303364917552653550856842078401609762474052731083931495306014107187124734457075224037315456491438791267519851845477867683733780384075756604261045748217132834309392462550755499981143432724085587109239757938408396490479725
```

Now we have 20 primes and the chiper text. The next step is to find the modulus `n` and the public exponent `e`. The modulus is the product of all the primes and the public exponent is a prime number which is coprime with `n`.

I used the following script to calculate the modulus, the Euler's totient function and the private exponent, and then decrypt the chiper text:

```python
#!/usr/bin/env python3

# To use bigger numbers than 10^4300, we need to set the max number of digits to 0
import sys
sys.set_int_max_str_digits(0)

with open('primes.txt', 'r') as f:
	primes = [int(line.strip()) for line in f.readlines()]

with open('chiper.txt', 'r') as f:
    chiper = int(f.readline().strip())

# Extended Euclidean algorithm
def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, x, y = egcd(b % a, a)
        return (g, y - (b // a) * x, x)

# Modular inverse
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('Modular inverse does not exist')
    else:
        return x % m

# RSA decryption
def rsa_decrypt(c, d, n):
    m = pow(c, d, n)
    return m

# Convert an integer to bytes
def int_to_bytes(x):
    return str(x.to_bytes((x.bit_length() + 7) // 8, 'big'))

# Public exponent
e = 65537

# Modulus
n = 1
for prime in primes:
	n *= prime

# Euler's totient function
phi = 1
for prime in primes:
	phi *= (prime - 1)

# Private exponent
d = modinv(e, phi)

# Decrypt the chiper text
m = rsa_decrypt(chiper, d, n)

# Convert the decrypted message to bytes
m = int_to_bytes(m)

# Print the decrypted message
print(m)
```

The decrypted message was:

```python
C = 297431603357014918635807141422077281003925729752516527757856363168005633704277723162076507858027119328842675844250802687503932808401983026964969064194920196519677966604353226312611645293234201762379786983247665439522616862023526984758206046361026688070011759593864620996341795717714506116632460670021745520283535491160994460799042881774453824511221649024289575838676682760802884770805709568154661437589710541774113274341167472095836800928470043071600821665463433160442811173914291434654855309837708544196668584669552854636978210854942393491640744248255951107396871390415895224212852248983667958524806230283441189570342927136088625047944637916588573281357827386574369858024676522707318918844717551746178228511956431102129266578463542045164134465520038065468198476750079425534810311749573766090742480775760176017230251263443193437255402852054609115465873318668516064946131223792775363967131773366715586568935559011008914158759825732195315819448054289206440216134993636943542591856077830512516883311129365545699358820114738512213765483201428357341327151070897834297028950288107157310222843198515959858124411178635100092384280292191923953332488404503931980386015127956200524803589211922018806221392426086295375434041334597699193524055692141978488706439180419792828033111303423005365764359915477615845938784892331013944131034991268928433418465343466349712934652508833299050601800492280333458067145480177293904352868894799770738589120310298258440627900238546574840278337246288499376107940122156268605259235083237124644139050540325709456875854132329746068301262251702761763940779098231707010733211786446043994003643949511668915180808117674840863001789508254888516086281156580625481499287060972536438256898350327620370348498555735810247211928726691622541743387750927189621706588917130593931581083202783195267174568546698498165060439942807627881611837464695100403448443252291672555140720349825021025460274417913466232286158491723368914876700898095272142053244686090775733407103853527120857961541836681771537144175190341533323462143659557066415109998122096039148215728485217367632975673134258722986969744366568938287329325397535952680266029632736621760623201916152336740628872561977431344316461095626204290893561690085440866047481360389605509192684120547700958855964303983855605251543038107062680935294156121377833358553854423204245936830110775729386809720407841323826560928398901894551137297315238731817421432393723370139428714486277460765489872806056850991701668376423785272
N = 864020562887492526231872746009532973017748544230538127020843066266818824132164180578304470546844498006477558655575971910692906818107042747081544008871492299878376884319197435937490153364660112975209292572822994585989588246996640660968932264729009418264506397722670498333440802830157819239018149962877847148517631046487024720820084299843686047592808152381749007330180747907020610602621111498410570445703686660135146604202794049489398920232948446231536205062612048353057816275242134469920369098898757714187880171863906024114529508861598324168019593164345406795942048113140430079122523114833352928764143532791325698903552784797871622552337598052841510697947320319113773088012332132425967901475234353475489950473030476713410298823987509383362302773882381484175795545386636991820192929379730440509523755159407499921176588223889058998859103663378577623767487561632422207811286739555765120510860323128695241391057687342360261337162309915490200928195702347061330561057056771413481620099196536940918325818510698669525484117961155826997994456916395751511545107959626957921161235166014690327875221453643337367085673932645707933238570348570997074320223963639257475001487627897274249912680450300799037018694675852456068279859358073091636662544871585040978955606438684062615303233486334091949598516408274553630513251799182415558426874049445763546926020551558510433850146960719584688875659058131835040797850464922654844912543252063283732043951505289568822319734789696998320219569858784120704415438947961386267025127012443950832620518539174570637341448180910830124411400125540029777187089801855341284566634672383425490834919714080468743494471509639429314018667823904608717612726497138130834125795115889516447188540868642247190646838462934910483813499965890936997778696103310933330294772707811397080572521710175681898754709174910935887797563283896506282619307885242388697648818919970723290911216255761832771702543291117405751221249337232084832359168502992963269336030946016323211410043889211414839012751630485949628754609715807304516367701963207478280727415286256464179031340545180302796237341007160938759571370862423385401612964800002714962620109874533747744788719275839342262693950854971622449607478090260597444064345673117433967958803255907369853352919167405084957442575635744490816622793520469047869934780884061074221507530272011855393976156944782280208960915267423642834968261199441485675137976898297786309728634107413746679954113088472454021690950790211949110759826106860373897
```

## Level 2

For this level we have a modulus `N` and a chiper text `C`.

As the challenge description says *Sometimes you need multiple primes, sometimes you need only one! Decrypt!*. This means the modulus itself is a prime number. So we only need to find the private exponent `d` and decrypt the chiper text.

I used the following script to calculate the private exponent and decrypt the chiper text:

```python
#!/usr/bin/env python3

# To use bigger numbers than 10^4300, we need to set the max number of digits to 0
import sys
sys.set_int_max_str_digits(0)

with open("level2.txt", "r") as f:
    lines = f.readlines()

n = int(lines[1].split('=')[1])
ct = int(lines[0].split('=')[1])

# Extended Euclidean algorithm
def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, x, y = egcd(b % a, a)
        return (g, y - (b // a) * x, x)

# Modular inverse
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('Modular inverse does not exist')
    else:
        return x % m

# RSA decryption
def rsa_decrypt(c, d, n):
    m = pow(c, d, n)
    return m

# Convert an integer to bytes
def int_to_bytes(x):
    return str(x.to_bytes((x.bit_length() + 7) // 8, 'big'))

# Public exponent
e = 65537

# Euler's totient function
phi = n - 1

# Private exponent
d = modinv(e, phi)

# Decrypt the chiper text
m = rsa_decrypt(ct, d, n)

# Convert the decrypted message to bytes
m = int_to_bytes(m)

# Print the decrypted message
print(m)
```

The decrypted message was the flag:

```text
HKN{l4r63-pr1m3-m0dulu5}
```
